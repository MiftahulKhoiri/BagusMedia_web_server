<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tentang Sistem - BAGUS MEDIA SERVER</title>

    <link rel="stylesheet" href="/static/css/neon.css">
    <link rel="stylesheet" href="/static/css/about.css">

    <link rel="icon" href="{{ url_for('static', filename='icon/icon.png') }}">
</head>
<body>

<canvas id="neonCanvas"></canvas>

<header class="header">
    <h1 class="title">Tentang Sistem</h1>

    {% if session.role == "root" %}
        <a href="/admin" class="btn-home">üè† Admin</a>
    {% else %}
        <a href="{{ url_for('main.home') }}" class="btn-home">üè† Home</a>
    {% endif %}
</header>

<main class="container">

    <!-- ============================
         KARTU INFORMASI APLIKASI
    ============================ -->
    <div class="card fade-in">
        <h2>üì¶ Informasi Aplikasi</h2>
        <p><strong>Nama Sistem:</strong> BAGUS MEDIA SERVER</p>
        <p><strong>Versi:</strong> {{ version }}</p>
        <p><strong>Developer:</strong> Bagus Choiri</p>
    </div>

    <!-- ============================
         KARTU INFORMASI SERVER
    ============================ -->
    <div class="card fade-in delay1">
        <h2>üñ•Ô∏è Informasi Server</h2>
        <p><strong>Sistem Operasi:</strong> {{ system }}</p>
        <p><strong>CPU:</strong> {{ cpu_count }} Core</p>
        <p><strong>RAM Total:</strong> {{ ram_total }} GB</p>
        <p><strong>RAM Terpakai:</strong> {{ ram_used }} GB</p>
        <p><strong>Disk Total:</strong> {{ disk_total }} GB</p>
        <p><strong>Disk Terpakai:</strong> {{ disk_used }} GB</p>
    </div>

    <!-- ============================
         STATUS SISTEM
    ============================ -->
    <div class="card fade-in delay2">
        <h2>‚ö° Status Sistem</h2>

        <p><b>Uptime:</b> {{ uptime }}</p>

        {% if alt_uptime %}
            <p><b>Uptime Alternatif:</b> {{ alt_uptime }}</p>
        {% endif %}

        <p><strong>IP Server:</strong> {{ ip_address }}</p>

        <p><strong>Lokasi Folder Aplikasi:</strong></p>
        <code>{{ project_root }}</code>
    </div>

    <!-- ============================
         REALTIME BAR MONITOR
    ============================ -->
    <div class="card fade-in delay3">
        <h2>üìä Realtime System Monitor</h2>

        <div class="monitor-row">
            <span>CPU</span>
            <div class="bar"><div id="cpu-bar" class="fill"></div></div>
            <span id="cpu-val">0%</span>
        </div>

        <div class="monitor-row">
            <span>RAM</span>
            <div class="bar"><div id="ram-bar" class="fill"></div></div>
            <span id="ram-val">0%</span>
        </div>

        <div class="monitor-row">
            <span>DISK</span>
            <div class="bar"><div id="disk-bar" class="fill"></div></div>
            <span id="disk-val">0%</span>
        </div>
    </div>

    <!-- ============================
         REALTIME CHARTS
    ============================ -->
    <div class="card fade-in delay4">
        <h2>üìà Grafik Realtime</h2>

        <canvas id="cpuChart"></canvas>
        <canvas id="ramChart"></canvas>
        <canvas id="diskChart"></canvas>
    </div>

</main>

<footer>
    <p>¬© {{ current_year }} BAGUS MEDIA SERVER ‚Äî Dibuat karena hobi üòÑ</p>
</footer>

<script src="/static/Js/neon.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- =======================================
     REALTIME BAR MONITOR
======================================= -->
<script>
async function updateMonitor() {
    try {
        const res = await fetch("/api/monitor");
        const d = await res.json();

        document.getElementById("cpu-bar").style.width = d.cpu + "%";
        document.getElementById("cpu-val").textContent = d.cpu + "%";

        document.getElementById("ram-bar").style.width = d.ram_percent + "%";
        document.getElementById("ram-val").textContent = d.ram_percent + "%";

        document.getElementById("disk-bar").style.width = d.disk_percent + "%";
        document.getElementById("disk-val").textContent = d.disk_percent + "%";
    } catch (e) {
        console.log("Monitor error:", e);
    }
}

setInterval(updateMonitor, 1000);
updateMonitor();
</script>

<!-- =======================================
     REALTIME CHARTS
======================================= -->
<script>
let labels = [];
let cpuData = [];
let ramData = [];
let diskData = [];

function createChart(id, label, color) {
    return new Chart(document.getElementById(id), {
        type: "line",
        data: {
            labels,
            datasets: [{
                label,
                data: [],
                borderColor: color,
                borderWidth: 2,
                tension: 0.3
            }]
        },
        options: {
            animation: false,
            scales: { y: { min: 0, max: 100 } }
        }
    });
}

let cpuChart = createChart("cpuChart", "CPU %", "#00ff00");
let ramChart = createChart("ramChart", "RAM %", "#33ff55");
let diskChart = createChart("diskChart", "Disk %", "#66ff88");

async function updateCharts() {
    try {
        const res = await fetch("/api/monitor");
        const d = await res.json();
        const t = new Date().toLocaleTimeString();

        labels.push(t);
        if (labels.length > 20) labels.shift();

        cpuData.push(d.cpu);
        if (cpuData.length > 20) cpuData.shift();

        ramData.push(d.ram_percent);
        if (ramData.length > 20) ramData.shift();

        diskData.push(d.disk_percent);
        if (diskData.length > 20) diskData.shift();

        cpuChart.data.datasets[0].data = cpuData;
        ramChart.data.datasets[0].data = ramData;
        diskChart.data.datasets[0].data = diskData;

        cpuChart.update();
        ramChart.update();
        diskChart.update();
    } catch (e) {
        console.log("Chart error:", e);
    }
}

setInterval(updateCharts, 1000);
</script>

</body>
</html>